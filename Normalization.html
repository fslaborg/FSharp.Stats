<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>Normalization</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="author" content="Benedikt Venn, Timo Muehlhaus, Heinrich Lukas Weil, David Zimmer, Kevin Schneider, fslab open source contributors">
    <link rel="shortcut icon" type="image/x-icon" href="https://fslab.org/FSharp.Stats//img/favicon.ico">
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-2.18.1.min.js"></script>
    <script>MathJax = { tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] } };</script>
    <script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-svg.js"></script>
    <link type="text/css" rel="stylesheet" href="https://fslab.org/FSharp.Stats/content/fsdocs-default.css" />
    <link type="text/css" rel="stylesheet" href="https://fslab.org/FSharp.Stats/content/fsdocs-custom.css" />
    <script type="text/javascript" src="https://fslab.org/FSharp.Stats/content/fsdocs-tips.js"></script>
    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <!-- BEGIN SEARCH BOX: this adds support for the search box -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/JavaScript-autoComplete/1.0.4/auto-complete.css" />
    <!-- END SEARCH BOX: this adds support for the search box -->
    
</head> 

<body>
    <div class="columns is-fullheight m-0">
        <div id="fsdocs-menu" class="column is-2 is-paddingless">
            <aside class="menu">
                <div class="container is-paddingless is-marginless has-background-light">
                    <a href="https://fslab.org/FSharp.Stats/">
                        <figure class="image is-128x128 container">
                            <img src="https://fslab.org/FSharp.Stats/img/logo.png">
                        </figure>
                    </a>
                    <h2 class="title has-text-centered has-text-fsstatsgrey pb-4">FSharp.Stats</h2>
                </div>
                <div class="content">
                    <!-- BEGIN SEARCH BOX: this adds support for the search box -->
                    <div id="header">
                        <div class="searchbox" id="fsdocs-searchbox">
                            <label for="search-by">
                                <i class="fas fa-search"></i>
                            </label>
                            <input data-search-input="" id="search-by" type="search" placeholder="Search..." class="input"/>
                            <span data-search-clear="">
                                <i class="fas fa-times"></i>
                            </span>
                        </div>
                    </div>
                    <!-- END SEARCH BOX: this adds support for the search box -->
                    <ul class="navbar-nav">
                        <li class="nav-header">Links</li>
                        <li class="nav-item" id="fsdocs-license-link"><a class="nav-link" href="https://github.com/fslaborg/FSharp.Stats/blob/developer/LICENSE">License (MIT)</a></li>
                        <li class="nav-item" id="fsdocs-release-notes-link"><a class="nav-link" href="https://github.com/fslaborg/FSharp.Stats/blob/developer/RELEASE_NOTES.md">Release Notes</a></li>
                        <li class="nav-item" id="fsdocs-repository-link"><a class="nav-link" href="https://github.com/fslaborg/FSharp.Stats/">Source Repository</a></li>
                        <li class="nav-header">
  Documentation
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://fslab.org/FSharp.Stats/BasicStats.html">
    Basic statistics
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://fslab.org/FSharp.Stats/Distributions.html">
    Probability distributions
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://fslab.org/FSharp.Stats/Testing.html">
    Statistical testing
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://fslab.org/FSharp.Stats/Matrix_Vector.html">
    Matrix and Vector
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://fslab.org/FSharp.Stats/LinearAlgebra.html">
    Linear Algebra
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://fslab.org/FSharp.Stats/Correlation.html">
    Correlation
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://fslab.org/FSharp.Stats/Covariance.html">
    Covariance
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://fslab.org/FSharp.Stats/Fitting.html">
    Fitting
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://fslab.org/FSharp.Stats/Interpolation.html">
    Interpolation
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://fslab.org/FSharp.Stats/GrowthCurve.html">
    Growth curve
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://fslab.org/FSharp.Stats/CrossValidation.html">
    Cross validation
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://fslab.org/FSharp.Stats/GoodnessOfFit.html">
    Fit quality
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://fslab.org/FSharp.Stats/Imputation.html">
    Imputation
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://fslab.org/FSharp.Stats/Clustering.html">
    Clustering
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://fslab.org/FSharp.Stats/ComparisonMetrics.html">
    Comparison metrics
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://fslab.org/FSharp.Stats/Differentiation.html">
    Differentiation
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://fslab.org/FSharp.Stats/Integration.html">
    Integration
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://fslab.org/FSharp.Stats/Signal.html">
    Signal processing
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://fslab.org/FSharp.Stats/Normalization.html">
    Normalization
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://fslab.org/FSharp.Stats/Rank.html">
    Ranking
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://fslab.org/FSharp.Stats/Quantiles.html">
    Quantile
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://fslab.org/FSharp.Stats/Intervals.html">
    Intervals
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://fslab.org/FSharp.Stats/ML.html">
    Machine Learning
  </a>
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://fslab.org/FSharp.Stats/Optimization.html">
    Optimization
  </a>
</li>
                        <li class="nav-header">
  API Reference
</li>             
<li class="nav-item">
  <a class="nav-link" href="https://fslab.org/FSharp.Stats/reference/index.html">
    All Namespaces
  </a>
</li>
                    </ul>
                </div>
            </aside>
        </div>
        <div class="column is-10 is-paddingless">
            <div class="section pt-4">
                <div class="container" id="fsdocs-content">
                    
<h1><a name="Normalization" class="anchor" href="#Normalization">Normalization</a></h1>
<p><a href="https://mybinder.org/v2/gh/fslaborg/FSharp.Stats/gh-pages?urlpath=/tree/home/jovyan/Normalization.ipynb"><img src="https://mybinder.org/badge_logo.svg" alt="Binder" /></a>
<a href="https://fslab.org/FSharp.Stats/Normalization.ipynb"><img src="https://fslab.org/FSharp.Stats/img/badge-notebook.svg" alt="Notebook" /></a></p>
<p><em>Summary:</em> this tutorial demonstrates multiple ways of data normalization accross several samples</p>
<h3><a name="Table-of-contents" class="anchor" href="#Table-of-contents">Table of contents</a></h3>
<ul>
<li><a href="#Introduction">Introduction</a></li>
<li><a href="#Median-of-ratios">Median of Ratios</a></li>
<li><a href="#Quantile-normalization">Quantile normalization</a></li>
</ul>
<h2><a name="Introduction" class="anchor" href="#Introduction">Introduction</a></h2>
<p>When you want to compare e.g. intensity measurements of elements between samples, you often have to normalize the samples in order
to be able to perform a valid comparison. Samples may vary in their average intensity just because of the technical nature of the measurement itself,
thereby shifting or distorting the underlying correct/real distribution. For the presented normalization strategies it is assumed that global changes across the samples are due to unwanted technical variability and only
a small number of elements are dysregulated (Zhao et al, 2020).</p>
<h2><a name="Median-of-ratios" class="anchor" href="#Median-of-ratios">Median of ratios</a></h2>
<p>To correct for batch effects or technical measurment differences the median of ratios normalization (MOR) can be applied.
As explained above, it expects that the majority of genes/proteins/elements do not differ between the conditions that should be compared <a href="https://doi.org/10.1186/s13059-014-0550-8">Love et al. 2014</a>.
At first a reference sample is determined by calculating the geometric mean of each of the <strong>n</strong> elements across all <strong>m</strong> samples. The calculation of the geometric mean as
the n<sup>th</sup> square root of the product of all values (1) seems odd, but when displayed as mean of the log-transformed data (2) it becomes clear, that the geometric
mean is just an outlier-insensitive measure of a robust average, which is intuitive to do when dealing with biological data or in general data with some extreme outliers.</p>
<ol>
<li><img src="https://render.githubusercontent.com/render/math?math=geomean = \sqrt[n]{\prod_{}^{}x}"></li>
<li><img src="https://render.githubusercontent.com/render/math?math=geomean = e^{\frac{1}{n}\sum_{}^{}log(x)}"></li>
</ol>
<p>After a reference sample for each row is determined, for each entry a correction factor to reach the reference is calculated. Each sample now has n associated correction factors.
By taking the median of those individual correction factors, an outlier-insensitive measure of the true correction factor is determined. By choosing the median it is assumed that in theory &gt;=50% of all
measured elements should not change between the measured samples.</p>
<p>No prior log-transform has to be applied before normalizing the data with this method. If required a log transform can be applied to the normalized values to restore homoscedasticity.</p>
<p>In the following a step-by-step introduction is given with finally applying <code>Signal.Normalization.medianOfRatios</code> function to the given data.</p>
<p><strong>1. Raw intensities for m=3 samples and n=6 elements:</strong></p>
<table>
<thead>
<tr class="header">
<th><p>elementID</p></th>
<th><p>sample1</p></th>
<th><p>sample2</p></th>
<th><p>sample3</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>g00</p></td>
<td><p>100</p></td>
<td><p>130</p></td>
<td><p>30</p></td>
</tr>
<tr class="even">
<td><p>g01</p></td>
<td><p>80</p></td>
<td><p>200</p></td>
<td><p>30</p></td>
</tr>
<tr class="odd">
<td><p>g02</p></td>
<td><p>0</p></td>
<td><p>50</p></td>
<td><p>0</p></td>
</tr>
<tr class="even">
<td><p>g03</p></td>
<td><p>40</p></td>
<td><p>50</p></td>
<td><p>20</p></td>
</tr>
<tr class="odd">
<td><p>g04</p></td>
<td><p>50</p></td>
<td><p>45</p></td>
<td><p>25</p></td>
</tr>
<tr class="even">
<td><p>g05</p></td>
<td><p>40</p></td>
<td><p>50</p></td>
<td><p>15</p></td>
</tr>
</tbody>
</table>

<p><strong>2. Zero intensities cannot be processed during the MOR-normalization.</strong>
Either imputation, row filtering or data transformation must be performed. In this example a single count is added to each intensity.
Note that this is not necessarily reasonable for every analysis! The reference sample is determined by calculating the geometric mean of every row.</p>
<table>
<thead>
<tr class="header">
<th><p>elementID</p></th>
<th><p>sample1</p></th>
<th><p>sample2</p></th>
<th><p>sample3</p></th>
<th><p>reference</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>g00</p></td>
<td><p>101</p></td>
<td><p>131</p></td>
<td><p>31</p></td>
<td><p>74.30</p></td>
</tr>
<tr class="even">
<td><p>g01</p></td>
<td><p>81</p></td>
<td><p>201</p></td>
<td><p>31</p></td>
<td><p>79.62</p></td>
</tr>
<tr class="odd">
<td><p>g02</p></td>
<td><p>1</p></td>
<td><p>51</p></td>
<td><p>1</p></td>
<td><p>3.71</p></td>
</tr>
<tr class="even">
<td><p>g03</p></td>
<td><p>41</p></td>
<td><p>51</p></td>
<td><p>21</p></td>
<td><p>35.28</p></td>
</tr>
<tr class="odd">
<td><p>g04</p></td>
<td><p>51</p></td>
<td><p>56</p></td>
<td><p>26</p></td>
<td><p>42.03</p></td>
</tr>
<tr class="even">
<td><p>g05</p></td>
<td><p>41</p></td>
<td><p>51</p></td>
<td><p>16</p></td>
<td><p>32.22</p></td>
</tr>
</tbody>
</table>

<p><strong>3. For every element the correction factor is determined by dividing it by its reference.</strong></p>
<table>
<thead>
<tr class="header">
<th><p>elementID</p></th>
<th><p>sample1</p></th>
<th><p>sample2</p></th>
<th><p>sample3</p></th>
<th><p>reference</p></th>
<th><p>corr1</p></th>
<th><p>corr2</p></th>
<th><p>corr3</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>g00</p></td>
<td><p>101</p></td>
<td><p>131</p></td>
<td><p>31</p></td>
<td><p>74.30</p></td>
<td><p>1.359</p></td>
<td><p>1.763</p></td>
<td><p>0.417</p></td>
</tr>
<tr class="even">
<td><p>g01</p></td>
<td><p>81</p></td>
<td><p>201</p></td>
<td><p>31</p></td>
<td><p>79.62</p></td>
<td><p>1.017</p></td>
<td><p>2.525</p></td>
<td><p>0.389</p></td>
</tr>
<tr class="odd">
<td><p>g02</p></td>
<td><p>1</p></td>
<td><p>51</p></td>
<td><p>1</p></td>
<td><p>3.71</p></td>
<td><p>0.270</p></td>
<td><p>13.752</p></td>
<td><p>0.270</p></td>
</tr>
<tr class="even">
<td><p>g03</p></td>
<td><p>41</p></td>
<td><p>51</p></td>
<td><p>21</p></td>
<td><p>35.28</p></td>
<td><p>1.162</p></td>
<td><p>1.446</p></td>
<td><p>0.595</p></td>
</tr>
<tr class="odd">
<td><p>g04</p></td>
<td><p>51</p></td>
<td><p>56</p></td>
<td><p>26</p></td>
<td><p>42.03</p></td>
<td><p>1.213</p></td>
<td><p>1.332</p></td>
<td><p>0.619</p></td>
</tr>
<tr class="even">
<td><p>g05</p></td>
<td><p>41</p></td>
<td><p>51</p></td>
<td><p>16</p></td>
<td><p>32.22</p></td>
<td><p>1.272</p></td>
<td><p>1.583</p></td>
<td><p>0.497</p></td>
</tr>
</tbody>
</table>

<p>It becomes apparent, that sample1 and sample2 are overrepresented and sample3 is underepresented. g02 and g03 are obviously outliers that differ between the samples.
These elements should not influence the correction factors. By determining the median of each sample correction column, a outlier insensitive approximation of the true correction
factor is achieved.</p>
<p><strong>4. The median of each correction factor column determines the final correction.</strong></p>
<table>
<thead>
<tr class="header">
<th><p>elementID</p></th>
<th><p>sample1</p></th>
<th><p>sample2</p></th>
<th><p>sample3</p></th>
<th><p>reference</p></th>
<th><p>corr1</p></th>
<th><p>corr2</p></th>
<th><p>corr3</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>g00</p></td>
<td><p>101</p></td>
<td><p>131</p></td>
<td><p>31</p></td>
<td><p>74.30</p></td>
<td><p>1.359</p></td>
<td><p>1.763</p></td>
<td><p>0.417</p></td>
</tr>
<tr class="even">
<td><p>g01</p></td>
<td><p>81</p></td>
<td><p>201</p></td>
<td><p>31</p></td>
<td><p>79.62</p></td>
<td><p>1.017</p></td>
<td><p>2.525</p></td>
<td><p>0.389</p></td>
</tr>
<tr class="odd">
<td><p>g02</p></td>
<td><p>1</p></td>
<td><p>51</p></td>
<td><p>1</p></td>
<td><p>3.71</p></td>
<td><p>0.270</p></td>
<td><p>13.752</p></td>
<td><p>0.270</p></td>
</tr>
<tr class="even">
<td><p>g03</p></td>
<td><p>41</p></td>
<td><p>51</p></td>
<td><p>21</p></td>
<td><p>35.28</p></td>
<td><p>1.162</p></td>
<td><p>1.446</p></td>
<td><p>0.595</p></td>
</tr>
<tr class="odd">
<td><p>g04</p></td>
<td><p>51</p></td>
<td><p>56</p></td>
<td><p>26</p></td>
<td><p>42.03</p></td>
<td><p>1.213</p></td>
<td><p>1.332</p></td>
<td><p>0.619</p></td>
</tr>
<tr class="even">
<td><p>g05</p></td>
<td><p>41</p></td>
<td><p>51</p></td>
<td><p>16</p></td>
<td><p>32.22</p></td>
<td><p>1.272</p></td>
<td><p>1.583</p></td>
<td><p>0.497</p></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td></td>
<td><p><strong>Median:</strong></p></td>
<td><p><strong>1.188</strong></p></td>
<td><p><strong>1.673</strong></p></td>
<td><p><strong>0.457</strong></p></td>
</tr>
</tbody>
</table>

<p><strong>5. Apply the correction factors to the original (untransformed) data.</strong></p>
<table>
<thead>
<tr class="header">
<th><p>elementID</p></th>
<th><p>sample1</p></th>
<th><p>sample2</p></th>
<th><p>sample3</p></th>
<th><p>reference</p></th>
<th><p>corr1</p></th>
<th><p>corr2</p></th>
<th><p>corr3</p></th>
<th></th>
<th><p>normedSample1</p></th>
<th><p>normedSample2</p></th>
<th><p>normedSample3</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>g00</p></td>
<td><p>101</p></td>
<td><p>131</p></td>
<td><p>31</p></td>
<td><p>74.30</p></td>
<td><p>1.359</p></td>
<td><p>1.763</p></td>
<td><p>0.417</p></td>
<td></td>
<td><p>84.19</p></td>
<td><p>77.71</p></td>
<td><p>65.66</p></td>
</tr>
<tr class="even">
<td><p>g01</p></td>
<td><p>81</p></td>
<td><p>201</p></td>
<td><p>31</p></td>
<td><p>79.62</p></td>
<td><p>1.017</p></td>
<td><p>2.525</p></td>
<td><p>0.389</p></td>
<td></td>
<td><p>67.35</p></td>
<td><p>119.5</p></td>
<td><p>565.66</p></td>
</tr>
<tr class="odd">
<td><p>g02</p></td>
<td><p>1</p></td>
<td><p>51</p></td>
<td><p>1</p></td>
<td><p>3.71</p></td>
<td><p>0.270</p></td>
<td><p>13.752</p></td>
<td><p>0.270</p></td>
<td></td>
<td><p>0.00</p></td>
<td><p>29.89</p></td>
<td><p>0.00</p></td>
</tr>
<tr class="even">
<td><p>g03</p></td>
<td><p>41</p></td>
<td><p>51</p></td>
<td><p>21</p></td>
<td><p>35.28</p></td>
<td><p>1.162</p></td>
<td><p>1.446</p></td>
<td><p>0.595</p></td>
<td></td>
<td><p>33.68</p></td>
<td><p>29.89</p></td>
<td><p>43.77</p></td>
</tr>
<tr class="odd">
<td><p>g04</p></td>
<td><p>51</p></td>
<td><p>56</p></td>
<td><p>26</p></td>
<td><p>42.03</p></td>
<td><p>1.213</p></td>
<td><p>1.332</p></td>
<td><p>0.619</p></td>
<td></td>
<td><p>42.10</p></td>
<td><p>32.88</p></td>
<td><p>54.72</p></td>
</tr>
<tr class="even">
<td><p>g05</p></td>
<td><p>41</p></td>
<td><p>51</p></td>
<td><p>16</p></td>
<td><p>32.22</p></td>
<td><p>1.272</p></td>
<td><p>1.583</p></td>
<td><p>0.497</p></td>
<td></td>
<td><p>33.68</p></td>
<td><p>29.89</p></td>
<td><p>32.83</p></td>
</tr>
<tr class="odd">
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td></td>
<td></td>
<td></td>
<td></td>
<td><p><strong>Median:</strong></p></td>
<td><p><strong>1.188</strong></p></td>
<td><p><strong>1.673</strong></p></td>
<td><p><strong>0.457</strong></p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>

<p>The normed intensities of the different elements now match a theoretical common intensity level.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">open</span> <span onmouseout="hideTip(event, 'fs11', 22)" onmouseover="showTip(event, 'fs11', 22)" class="id">FSharp</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs12', 23)" onmouseover="showTip(event, 'fs12', 23)" class="id">Stats</span>


<span class="k">let</span> <span onmouseout="hideTip(event, 'fs13', 24)" onmouseover="showTip(event, 'fs13', 24)" class="id">rawData</span> <span class="o">=</span> 
    <span class="pn">[|</span>
    <span class="pn">[|</span><span class="n">100.</span><span class="pn">;</span> <span class="n">130.</span><span class="pn">;</span> <span class="n">30.</span><span class="pn">|]</span>
    <span class="pn">[|</span> <span class="n">80.</span><span class="pn">;</span> <span class="n">200.</span><span class="pn">;</span> <span class="n">30.</span><span class="pn">|]</span>
    <span class="pn">[|</span>  <span class="n">0.</span><span class="pn">;</span>  <span class="n">50.</span><span class="pn">;</span>  <span class="n">0.</span><span class="pn">|]</span>
    <span class="pn">[|</span> <span class="n">40.</span><span class="pn">;</span>  <span class="n">50.</span><span class="pn">;</span> <span class="n">20.</span><span class="pn">|]</span>
    <span class="pn">[|</span> <span class="n">50.</span><span class="pn">;</span>  <span class="n">45.</span><span class="pn">;</span> <span class="n">25.</span><span class="pn">|]</span>
    <span class="pn">[|</span> <span class="n">40.</span><span class="pn">;</span>  <span class="n">50.</span><span class="pn">;</span> <span class="n">15.</span><span class="pn">|]</span>
    <span class="pn">|]</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs14', 25)" onmouseover="showTip(event, 'fs14', 25)" class="fn">matrix</span>

<span class="c">// visualization of the raw data</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs15', 26)" onmouseover="showTip(event, 'fs15', 26)" class="id">rawDataChart</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs13', 27)" onmouseover="showTip(event, 'fs13', 27)" class="id">rawData</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs16', 28)" onmouseover="showTip(event, 'fs16', 28)" class="id">Transpose</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs17', 29)" onmouseover="showTip(event, 'fs17', 29)" class="m">Matrix</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs18', 30)" onmouseover="showTip(event, 'fs18', 30)" class="id">toJaggedArray</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs19', 31)" onmouseover="showTip(event, 'fs19', 31)" class="m">Array</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs20', 32)" onmouseover="showTip(event, 'fs20', 32)" class="id">mapi</span> <span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs21', 33)" onmouseover="showTip(event, 'fs21', 33)" class="fn">sampleID</span> <span onmouseout="hideTip(event, 'fs22', 34)" onmouseover="showTip(event, 'fs22', 34)" class="fn">sample</span> <span class="k">-&gt;</span> 
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs23', 35)" onmouseover="showTip(event, 'fs23', 35)" class="fn">sampleIntensities</span> <span class="o">=</span> 
            <span onmouseout="hideTip(event, 'fs22', 36)" onmouseover="showTip(event, 'fs22', 36)" class="fn">sample</span> 
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs19', 37)" onmouseover="showTip(event, 'fs19', 37)" class="m">Array</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs20', 38)" onmouseover="showTip(event, 'fs20', 38)" class="id">mapi</span> <span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs24', 39)" onmouseover="showTip(event, 'fs24', 39)" class="fn">gID</span> <span onmouseout="hideTip(event, 'fs25', 40)" onmouseover="showTip(event, 'fs25', 40)" class="fn">intensity</span> <span class="k">-&gt;</span>
                <span onmouseout="hideTip(event, 'fs24', 41)" onmouseover="showTip(event, 'fs24', 41)" class="fn">gID</span><span class="pn">,</span><span onmouseout="hideTip(event, 'fs25', 42)" onmouseover="showTip(event, 'fs25', 42)" class="fn">intensity</span>
            <span class="pn">)</span>
        <span onmouseout="hideTip(event, 'fs26', 43)" onmouseover="showTip(event, 'fs26', 43)" class="rt">Chart</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs27', 44)" onmouseover="showTip(event, 'fs27', 44)" class="id">Column</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs23', 45)" onmouseover="showTip(event, 'fs23', 45)" class="fn">sampleIntensities</span><span class="pn">,</span><span onmouseout="hideTip(event, 'fs28', 46)" onmouseover="showTip(event, 'fs28', 46)" class="fn">Name</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs29', 47)" onmouseover="showTip(event, 'fs29', 47)" class="fn">sprintf</span> <span class="s">&quot;raw sample</span><span class="pf">%i</span><span class="s">&quot;</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs21', 48)" onmouseover="showTip(event, 'fs21', 48)" class="fn">sampleID</span><span class="o">+</span><span class="n">1</span><span class="pn">)</span><span class="pn">)</span>
    <span class="pn">)</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs26', 49)" onmouseover="showTip(event, 'fs26', 49)" class="rt">Chart</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs30', 50)" onmouseover="showTip(event, 'fs30', 50)" class="id">combine</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs26', 51)" onmouseover="showTip(event, 'fs26', 51)" class="rt">Chart</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs31', 52)" onmouseover="showTip(event, 'fs31', 52)" class="id">withTemplate</span> <span onmouseout="hideTip(event, 'fs32', 53)" onmouseover="showTip(event, 'fs32', 53)" class="m">ChartTemplates</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs33', 54)" onmouseover="showTip(event, 'fs33', 54)" class="id">lightMirrored</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs26', 55)" onmouseover="showTip(event, 'fs26', 55)" class="rt">Chart</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs34', 56)" onmouseover="showTip(event, 'fs34', 56)" class="id">withXAxisStyle</span> <span class="s">&quot;gID&quot;</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs26', 57)" onmouseover="showTip(event, 'fs26', 57)" class="rt">Chart</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs35', 58)" onmouseover="showTip(event, 'fs35', 58)" class="id">withYAxisStyle</span> <span class="s">&quot;raw intensity&quot;</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs26', 59)" onmouseover="showTip(event, 'fs26', 59)" class="rt">Chart</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs36', 60)" onmouseover="showTip(event, 'fs36', 60)" class="id">withTitle</span> <span class="s">&quot;raw data&quot;</span>
</code></pre>
<div><div id="9a7ae66d-ef90-4fc5-8c58-101905f54d0b"><!-- Plotly chart will be drawn inside this DIV --></div><script type="text/javascript">var renderPlotly_9a7ae66def904fc58c58101905f54d0b = function() {
    var data = [{"type":"bar","name":"raw sample1","x":[0,1,2,3,4,5],"y":[100.0,80.0,0.0,40.0,50.0,40.0],"orientation":"v","marker":{"pattern":{}}},{"type":"bar","name":"raw sample2","x":[0,1,2,3,4,5],"y":[130.0,200.0,50.0,50.0,45.0,50.0],"orientation":"v","marker":{"pattern":{}}},{"type":"bar","name":"raw sample3","x":[0,1,2,3,4,5],"y":[30.0,30.0,0.0,20.0,25.0,15.0],"orientation":"v","marker":{"pattern":{}}}];
    var layout = {"width":600,"height":600,"template":{"layout":{"paper_bgcolor":"white","plot_bgcolor":"white","xaxis":{"ticks":"inside","mirror":"all","showline":true,"zeroline":true},"yaxis":{"ticks":"inside","mirror":"all","showline":true,"zeroline":true}},"data":{}},"xaxis":{"title":{"text":"gID"}},"yaxis":{"title":{"text":"raw intensity"}},"title":{"text":"raw data"}};
    var config = {"responsive":true};
    Plotly.newPlot('9a7ae66d-ef90-4fc5-8c58-101905f54d0b', data, layout, config);
};
renderPlotly_9a7ae66def904fc58c58101905f54d0b();
</script></div>
<p>In the above figure you can see, that the green sample is underrepresented, and the orange is overrepresented when compared to the blue one.
No the MOR normalization is applied. If no transformation (+1) should be applied, you can use <code>Signal.Normalization.medianOfRatios</code>.</p>
<pre class="fssnip highlighted"><code lang="fsharp"><span class="c">/// actual median of ratios normalization. 1 is added to each intensity to get rid of the empty intensities.</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs39', 64)" onmouseover="showTip(event, 'fs39', 64)" class="id">mor</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs40', 65)" onmouseover="showTip(event, 'fs40', 65)" class="id">Signal</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs41', 66)" onmouseover="showTip(event, 'fs41', 66)" class="m">Normalization</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs42', 67)" onmouseover="showTip(event, 'fs42', 67)" class="id">medianOfRatiosBy</span> <span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs43', 68)" onmouseover="showTip(event, 'fs43', 68)" class="fn">x</span> <span class="k">-&gt;</span> <span onmouseout="hideTip(event, 'fs43', 69)" onmouseover="showTip(event, 'fs43', 69)" class="fn">x</span> <span class="o">+</span> <span class="n">1.0</span><span class="pn">)</span> <span onmouseout="hideTip(event, 'fs13', 70)" onmouseover="showTip(event, 'fs13', 70)" class="id">rawData</span>

<span class="c">/// Matrix of normalized data in the same order as the input matrix</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs44', 71)" onmouseover="showTip(event, 'fs44', 71)" class="id">morNormedData</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs39', 72)" onmouseover="showTip(event, 'fs39', 72)" class="id">mor</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs45', 73)" onmouseover="showTip(event, 'fs45', 73)" class="id">NormedData</span>

<span class="c">/// Correction factors to assess the strenght of the applied normalization (1 indicates no normalization)</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs46', 74)" onmouseover="showTip(event, 'fs46', 74)" class="id">corrFactors</span> <span class="o">=</span> 
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs47', 75)" onmouseover="showTip(event, 'fs47', 75)" class="fn">cf1</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs48', 76)" onmouseover="showTip(event, 'fs48', 76)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs49', 77)" onmouseover="showTip(event, 'fs49', 77)" class="id">item</span> <span class="n">0</span> <span onmouseout="hideTip(event, 'fs39', 78)" onmouseover="showTip(event, 'fs39', 78)" class="id">mor</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs50', 79)" onmouseover="showTip(event, 'fs50', 79)" class="id">CorrFactors</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs51', 80)" onmouseover="showTip(event, 'fs51', 80)" class="fn">cf2</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs48', 81)" onmouseover="showTip(event, 'fs48', 81)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs49', 82)" onmouseover="showTip(event, 'fs49', 82)" class="id">item</span> <span class="n">1</span> <span onmouseout="hideTip(event, 'fs39', 83)" onmouseover="showTip(event, 'fs39', 83)" class="id">mor</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs50', 84)" onmouseover="showTip(event, 'fs50', 84)" class="id">CorrFactors</span>
    <span class="k">let</span> <span onmouseout="hideTip(event, 'fs52', 85)" onmouseover="showTip(event, 'fs52', 85)" class="fn">cf3</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs48', 86)" onmouseover="showTip(event, 'fs48', 86)" class="m">Seq</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs49', 87)" onmouseover="showTip(event, 'fs49', 87)" class="id">item</span> <span class="n">2</span> <span onmouseout="hideTip(event, 'fs39', 88)" onmouseover="showTip(event, 'fs39', 88)" class="id">mor</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs50', 89)" onmouseover="showTip(event, 'fs50', 89)" class="id">CorrFactors</span>
    <span onmouseout="hideTip(event, 'fs29', 90)" onmouseover="showTip(event, 'fs29', 90)" class="fn">sprintf</span> <span class="s">&quot;Correctionfactor for sample1 is </span><span class="pf">%.3f</span><span class="s">\nCorrectionfactor for sample2 is </span><span class="pf">%.3f</span><span class="s">\nCorrectionfactor for sample3 is </span><span class="pf">%.3f</span><span class="s">&quot;</span> <span onmouseout="hideTip(event, 'fs47', 91)" onmouseover="showTip(event, 'fs47', 91)" class="fn">cf1</span> <span onmouseout="hideTip(event, 'fs51', 92)" onmouseover="showTip(event, 'fs51', 92)" class="fn">cf2</span> <span onmouseout="hideTip(event, 'fs52', 93)" onmouseover="showTip(event, 'fs52', 93)" class="fn">cf3</span>
</code></pre>
Correctionfactor for sample1 is 1.217
Correctionfactor for sample2 is 1.673
Correctionfactor for sample3 is 0.457
<pre class="fssnip highlighted"><code lang="fsharp"><span class="c">// visualization of the normed data</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs53', 95)" onmouseover="showTip(event, 'fs53', 95)" class="id">normedDataChart</span> <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs44', 96)" onmouseover="showTip(event, 'fs44', 96)" class="id">morNormedData</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs16', 97)" onmouseover="showTip(event, 'fs16', 97)" class="id">Transpose</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs17', 98)" onmouseover="showTip(event, 'fs17', 98)" class="m">Matrix</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs18', 99)" onmouseover="showTip(event, 'fs18', 99)" class="id">toJaggedArray</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs19', 100)" onmouseover="showTip(event, 'fs19', 100)" class="m">Array</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs20', 101)" onmouseover="showTip(event, 'fs20', 101)" class="id">mapi</span> <span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs21', 102)" onmouseover="showTip(event, 'fs21', 102)" class="fn">sampleID</span> <span onmouseout="hideTip(event, 'fs22', 103)" onmouseover="showTip(event, 'fs22', 103)" class="fn">sample</span> <span class="k">-&gt;</span> 
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs23', 104)" onmouseover="showTip(event, 'fs23', 104)" class="fn">sampleIntensities</span> <span class="o">=</span> 
            <span onmouseout="hideTip(event, 'fs22', 105)" onmouseover="showTip(event, 'fs22', 105)" class="fn">sample</span> 
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs19', 106)" onmouseover="showTip(event, 'fs19', 106)" class="m">Array</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs20', 107)" onmouseover="showTip(event, 'fs20', 107)" class="id">mapi</span> <span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs24', 108)" onmouseover="showTip(event, 'fs24', 108)" class="fn">gID</span> <span onmouseout="hideTip(event, 'fs25', 109)" onmouseover="showTip(event, 'fs25', 109)" class="fn">intensity</span> <span class="k">-&gt;</span>
                <span onmouseout="hideTip(event, 'fs24', 110)" onmouseover="showTip(event, 'fs24', 110)" class="fn">gID</span><span class="pn">,</span><span onmouseout="hideTip(event, 'fs25', 111)" onmouseover="showTip(event, 'fs25', 111)" class="fn">intensity</span>
            <span class="pn">)</span>
        <span onmouseout="hideTip(event, 'fs26', 112)" onmouseover="showTip(event, 'fs26', 112)" class="rt">Chart</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs27', 113)" onmouseover="showTip(event, 'fs27', 113)" class="id">Column</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs23', 114)" onmouseover="showTip(event, 'fs23', 114)" class="fn">sampleIntensities</span><span class="pn">,</span><span onmouseout="hideTip(event, 'fs28', 115)" onmouseover="showTip(event, 'fs28', 115)" class="fn">Name</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs29', 116)" onmouseover="showTip(event, 'fs29', 116)" class="fn">sprintf</span> <span class="s">&quot;MOR normed sample</span><span class="pf">%i</span><span class="s">&quot;</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs21', 117)" onmouseover="showTip(event, 'fs21', 117)" class="fn">sampleID</span><span class="o">+</span><span class="n">1</span><span class="pn">)</span><span class="pn">)</span>
    <span class="pn">)</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs26', 118)" onmouseover="showTip(event, 'fs26', 118)" class="rt">Chart</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs30', 119)" onmouseover="showTip(event, 'fs30', 119)" class="id">combine</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs26', 120)" onmouseover="showTip(event, 'fs26', 120)" class="rt">Chart</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs31', 121)" onmouseover="showTip(event, 'fs31', 121)" class="id">withTemplate</span> <span onmouseout="hideTip(event, 'fs32', 122)" onmouseover="showTip(event, 'fs32', 122)" class="m">ChartTemplates</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs33', 123)" onmouseover="showTip(event, 'fs33', 123)" class="id">lightMirrored</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs26', 124)" onmouseover="showTip(event, 'fs26', 124)" class="rt">Chart</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs34', 125)" onmouseover="showTip(event, 'fs34', 125)" class="id">withXAxisStyle</span> <span class="s">&quot;gID&quot;</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs26', 126)" onmouseover="showTip(event, 'fs26', 126)" class="rt">Chart</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs35', 127)" onmouseover="showTip(event, 'fs35', 127)" class="id">withYAxisStyle</span> <span class="s">&quot;MOR intensity&quot;</span>
</code></pre>
<div><div id="56d0eed7-1859-41fe-acb4-c7aa04685560"><!-- Plotly chart will be drawn inside this DIV --></div><script type="text/javascript">var renderPlotly_56d0eed7185941feacb4c7aa04685560 = function() {
    var data = [{"type":"bar","name":"MOR normed sample1","x":[0,1,2,3,4,5],"y":[82.15073918013081,65.72059134410465,0.0,32.860295672052324,41.07536959006541,32.860295672052324],"orientation":"v","marker":{"pattern":{}}},{"type":"bar","name":"MOR normed sample2","x":[0,1,2,3,4,5],"y":[77.7073168717368,119.54971826421045,29.887429566052614,29.887429566052614,26.898686609447353,29.887429566052614],"orientation":"v","marker":{"pattern":{}}},{"type":"bar","name":"MOR normed sample3","x":[0,1,2,3,4,5],"y":[65.66130664839933,65.66130664839933,0.0,43.77420443226622,54.717755540332774,32.830653324199666],"orientation":"v","marker":{"pattern":{}}}];
    var layout = {"width":600,"height":600,"template":{"layout":{"paper_bgcolor":"white","plot_bgcolor":"white","xaxis":{"ticks":"inside","mirror":"all","showline":true,"zeroline":true},"yaxis":{"ticks":"inside","mirror":"all","showline":true,"zeroline":true}},"data":{}},"xaxis":{"title":{"text":"gID"}},"yaxis":{"title":{"text":"MOR intensity"}}};
    var config = {"responsive":true};
    Plotly.newPlot('56d0eed7-1859-41fe-acb4-c7aa04685560', data, layout, config);
};
renderPlotly_56d0eed7185941feacb4c7aa04685560();
</script></div>
<p>The normed data now shows high similarity of the individual element intensities across samples.</p>
<h1><a name="Quantile-normalization" class="anchor" href="#Quantile-normalization">Quantile normalization</a></h1>
<p>To compensate for the technical variance you also can perform a quantile normalization. It is a technique for making two or more
distributions identical in statistical properties and was originally developed for gene expression microarrays. It sees widespread use, constituting a standard part
of analysis pipelines for high-throughput analysis.
You can either quantile normalize data according to a given reference distribution (e.g. Gamma or Normal distribution) or create your own reference distribution out of your samples.</p>
<p>The same dataset as above is used and a quantile normalization is performed. Since no log transform is applied, there is no necessity to add a constant to each intensity:</p>
<p><strong>1. Raw intensities for m=3 samples and n=6 elements:</strong></p>
<table>
<thead>
<tr class="header">
<th><p>elementID</p></th>
<th><p>sample1</p></th>
<th><p>sample2</p></th>
<th><p>sample3</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>g00</p></td>
<td><p>100</p></td>
<td><p>130</p></td>
<td><p>30</p></td>
</tr>
<tr class="even">
<td><p>g01</p></td>
<td><p>80</p></td>
<td><p>200</p></td>
<td><p>30</p></td>
</tr>
<tr class="odd">
<td><p>g02</p></td>
<td><p>0</p></td>
<td><p>50</p></td>
<td><p>0</p></td>
</tr>
<tr class="even">
<td><p>g03</p></td>
<td><p>40</p></td>
<td><p>50</p></td>
<td><p>20</p></td>
</tr>
<tr class="odd">
<td><p>g04</p></td>
<td><p>50</p></td>
<td><p>45</p></td>
<td><p>25</p></td>
</tr>
<tr class="even">
<td><p>g05</p></td>
<td><p>40</p></td>
<td><p>50</p></td>
<td><p>15</p></td>
</tr>
</tbody>
</table>

<p><strong>2. Intensities are indexed and sorted in ascending order. The row average intensity is determined.</strong></p>
<table>
<thead>
<tr class="header">
<th><p>sample1</p></th>
<th><p>sample2</p></th>
<th><p>sample3</p></th>
<th></th>
<th><p>row average</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>3 -&gt; 0</p></td>
<td><p>5 -&gt; 45</p></td>
<td><p>3 -&gt; 0</p></td>
<td></td>
<td><p>15</p></td>
</tr>
<tr class="even">
<td><p>4 -&gt; 40</p></td>
<td><p>3 -&gt; 50</p></td>
<td><p>6 -&gt; 15</p></td>
<td></td>
<td><p>35</p></td>
</tr>
<tr class="odd">
<td><p>6 -&gt; 40</p></td>
<td><p>4 -&gt; 50</p></td>
<td><p>4 -&gt; 20</p></td>
<td></td>
<td><p>36.7</p></td>
</tr>
<tr class="even">
<td><p>5 -&gt; 50</p></td>
<td><p>6 -&gt; 50</p></td>
<td><p>5 -&gt; 25</p></td>
<td></td>
<td><p>41.7</p></td>
</tr>
<tr class="odd">
<td><p>2 -&gt; 80</p></td>
<td><p>1 -&gt; 130</p></td>
<td><p>1 -&gt; 30</p></td>
<td></td>
<td><p>80</p></td>
</tr>
<tr class="even">
<td><p>1 -&gt; 100</p></td>
<td><p>2 -&gt; 200</p></td>
<td><p>2 -&gt; 30</p></td>
<td></td>
<td><p>110</p></td>
</tr>
</tbody>
</table>

<p><strong>3. Every intensity is replaced by the row average intensity</strong></p>
<table>
<thead>
<tr class="header">
<th><p>sample1</p></th>
<th><p>sample2</p></th>
<th><p>sample3</p></th>
<th></th>
<th><p>row average</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>3;15</p></td>
<td><p>5;15</p></td>
<td><p>3;15</p></td>
<td></td>
<td><p>15</p></td>
</tr>
<tr class="even">
<td><p>4;35</p></td>
<td><p>3;35</p></td>
<td><p>6;35</p></td>
<td></td>
<td><p>35</p></td>
</tr>
<tr class="odd">
<td><p>6;36.7</p></td>
<td><p>4;36.7</p></td>
<td><p>4;36.7</p></td>
<td></td>
<td><p>36.7</p></td>
</tr>
<tr class="even">
<td><p>5;41.7</p></td>
<td><p>6;41.7</p></td>
<td><p>5;41.7</p></td>
<td></td>
<td><p>41.7</p></td>
</tr>
<tr class="odd">
<td><p>2;80</p></td>
<td><p>1;80</p></td>
<td><p>1;80</p></td>
<td></td>
<td><p>80</p></td>
</tr>
<tr class="even">
<td><p>1;110</p></td>
<td><p>2;110</p></td>
<td><p>2;110</p></td>
<td></td>
<td><p>110</p></td>
</tr>
</tbody>
</table>

<p><strong>4. Finally the columns are resorted to their original order using the indices. The indices are removed</strong></p>
<table>
<thead>
<tr class="header">
<th><p>elementID</p></th>
<th><p>normedSample1</p></th>
<th><p>normedSample2</p></th>
<th><p>normedSample3</p></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><p>g00</p></td>
<td><p>110</p></td>
<td><p>80</p></td>
<td><p>80</p></td>
</tr>
<tr class="even">
<td><p>g01</p></td>
<td><p>80</p></td>
<td><p>110</p></td>
<td><p>110</p></td>
</tr>
<tr class="odd">
<td><p>g02</p></td>
<td><p>15</p></td>
<td><p>35</p></td>
<td><p>15</p></td>
</tr>
<tr class="even">
<td><p>g03</p></td>
<td><p>35</p></td>
<td><p>36.7</p></td>
<td><p>36.7</p></td>
</tr>
<tr class="odd">
<td><p>g04</p></td>
<td><p>41.7</p></td>
<td><p>15</p></td>
<td><p>41.7</p></td>
</tr>
<tr class="even">
<td><p>g05</p></td>
<td><p>36.7</p></td>
<td><p>41.7</p></td>
<td><p>35</p></td>
</tr>
</tbody>
</table>

<pre class="fssnip highlighted"><code lang="fsharp"><span class="k">let</span> <span onmouseout="hideTip(event, 'fs54', 131)" onmouseover="showTip(event, 'fs54', 131)" class="id">quantileNorm</span> <span class="o">=</span> 
    <span onmouseout="hideTip(event, 'fs40', 132)" onmouseover="showTip(event, 'fs40', 132)" class="id">Signal</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs41', 133)" onmouseover="showTip(event, 'fs41', 133)" class="m">Normalization</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs55', 134)" onmouseover="showTip(event, 'fs55', 134)" class="id">quantile</span> <span onmouseout="hideTip(event, 'fs13', 135)" onmouseover="showTip(event, 'fs13', 135)" class="id">rawData</span>

<span class="c">// visualization of the normed data</span>
<span class="k">let</span> <span onmouseout="hideTip(event, 'fs56', 136)" onmouseover="showTip(event, 'fs56', 136)" class="id">normedDataQuantileChart</span> <span class="o">=</span>
    <span onmouseout="hideTip(event, 'fs54', 137)" onmouseover="showTip(event, 'fs54', 137)" class="id">quantileNorm</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs16', 138)" onmouseover="showTip(event, 'fs16', 138)" class="id">Transpose</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs17', 139)" onmouseover="showTip(event, 'fs17', 139)" class="m">Matrix</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs18', 140)" onmouseover="showTip(event, 'fs18', 140)" class="id">toJaggedArray</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs19', 141)" onmouseover="showTip(event, 'fs19', 141)" class="m">Array</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs20', 142)" onmouseover="showTip(event, 'fs20', 142)" class="id">mapi</span> <span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs21', 143)" onmouseover="showTip(event, 'fs21', 143)" class="fn">sampleID</span> <span onmouseout="hideTip(event, 'fs22', 144)" onmouseover="showTip(event, 'fs22', 144)" class="fn">sample</span> <span class="k">-&gt;</span> 
        <span class="k">let</span> <span onmouseout="hideTip(event, 'fs23', 145)" onmouseover="showTip(event, 'fs23', 145)" class="fn">sampleIntensities</span> <span class="o">=</span> 
            <span onmouseout="hideTip(event, 'fs22', 146)" onmouseover="showTip(event, 'fs22', 146)" class="fn">sample</span> 
            <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs19', 147)" onmouseover="showTip(event, 'fs19', 147)" class="m">Array</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs20', 148)" onmouseover="showTip(event, 'fs20', 148)" class="id">mapi</span> <span class="pn">(</span><span class="k">fun</span> <span onmouseout="hideTip(event, 'fs24', 149)" onmouseover="showTip(event, 'fs24', 149)" class="fn">gID</span> <span onmouseout="hideTip(event, 'fs25', 150)" onmouseover="showTip(event, 'fs25', 150)" class="fn">intensity</span> <span class="k">-&gt;</span>
                <span onmouseout="hideTip(event, 'fs24', 151)" onmouseover="showTip(event, 'fs24', 151)" class="fn">gID</span><span class="pn">,</span><span onmouseout="hideTip(event, 'fs25', 152)" onmouseover="showTip(event, 'fs25', 152)" class="fn">intensity</span>
            <span class="pn">)</span>
        <span onmouseout="hideTip(event, 'fs26', 153)" onmouseover="showTip(event, 'fs26', 153)" class="rt">Chart</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs27', 154)" onmouseover="showTip(event, 'fs27', 154)" class="id">Column</span><span class="pn">(</span><span onmouseout="hideTip(event, 'fs23', 155)" onmouseover="showTip(event, 'fs23', 155)" class="fn">sampleIntensities</span><span class="pn">,</span><span onmouseout="hideTip(event, 'fs28', 156)" onmouseover="showTip(event, 'fs28', 156)" class="fn">Name</span> <span class="o">=</span> <span onmouseout="hideTip(event, 'fs29', 157)" onmouseover="showTip(event, 'fs29', 157)" class="fn">sprintf</span> <span class="s">&quot;quantile normed sample</span><span class="pf">%i</span><span class="s">&quot;</span> <span class="pn">(</span><span onmouseout="hideTip(event, 'fs21', 158)" onmouseover="showTip(event, 'fs21', 158)" class="fn">sampleID</span><span class="o">+</span><span class="n">1</span><span class="pn">)</span><span class="pn">)</span>
    <span class="pn">)</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs26', 159)" onmouseover="showTip(event, 'fs26', 159)" class="rt">Chart</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs30', 160)" onmouseover="showTip(event, 'fs30', 160)" class="id">combine</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs26', 161)" onmouseover="showTip(event, 'fs26', 161)" class="rt">Chart</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs31', 162)" onmouseover="showTip(event, 'fs31', 162)" class="id">withTemplate</span> <span onmouseout="hideTip(event, 'fs32', 163)" onmouseover="showTip(event, 'fs32', 163)" class="m">ChartTemplates</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs33', 164)" onmouseover="showTip(event, 'fs33', 164)" class="id">lightMirrored</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs26', 165)" onmouseover="showTip(event, 'fs26', 165)" class="rt">Chart</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs34', 166)" onmouseover="showTip(event, 'fs34', 166)" class="id">withXAxisStyle</span> <span class="s">&quot;gID&quot;</span>
    <span class="o">|&gt;</span> <span onmouseout="hideTip(event, 'fs26', 167)" onmouseover="showTip(event, 'fs26', 167)" class="rt">Chart</span><span class="pn">.</span><span onmouseout="hideTip(event, 'fs35', 168)" onmouseover="showTip(event, 'fs35', 168)" class="id">withYAxisStyle</span> <span class="s">&quot;qNorm intensity&quot;</span>
</code></pre>
<div><div id="0bb7e2e4-5971-4ca2-b5f2-2e5b8e687a8a"><!-- Plotly chart will be drawn inside this DIV --></div><script type="text/javascript">var renderPlotly_0bb7e2e459714ca2b5f22e5b8e687a8a = function() {
    var data = [{"type":"bar","name":"quantile normed sample1","x":[0,1,2,3,4,5],"y":[110.0,80.0,15.0,35.0,41.666666666666664,36.666666666666664],"orientation":"v","marker":{"pattern":{}}},{"type":"bar","name":"quantile normed sample2","x":[0,1,2,3,4,5],"y":[80.0,110.0,35.0,36.666666666666664,15.0,41.666666666666664],"orientation":"v","marker":{"pattern":{}}},{"type":"bar","name":"quantile normed sample3","x":[0,1,2,3,4,5],"y":[80.0,110.0,15.0,36.666666666666664,41.666666666666664,35.0],"orientation":"v","marker":{"pattern":{}}}];
    var layout = {"width":600,"height":600,"template":{"layout":{"paper_bgcolor":"white","plot_bgcolor":"white","xaxis":{"ticks":"inside","mirror":"all","showline":true,"zeroline":true},"yaxis":{"ticks":"inside","mirror":"all","showline":true,"zeroline":true}},"data":{}},"xaxis":{"title":{"text":"gID"}},"yaxis":{"title":{"text":"qNorm intensity"}}};
    var config = {"responsive":true};
    Plotly.newPlot('0bb7e2e4-5971-4ca2-b5f2-2e5b8e687a8a', data, layout, config);
};
renderPlotly_0bb7e2e459714ca2b5f22e5b8e687a8a();
</script></div>
<p>As seen in the normalized column chart, the final samples all consists of the same values, just assigned to different row indices according to the rank within the sample.
For data with low row count, this normalization is not appropriate because there is a severe disturbance of the intensity values. The more data is incorporated (more rows), the lower
the single value influence will be.</p>
<h2><a name="Notes" class="anchor" href="#Notes">Notes</a></h2>
<p>You can assess the quality of your normalization by performing a PCA prior and after normalization and compare different normalization strategies. While the
correction factors for MOR can be investigated, quantile normalization is a non-linear transformation since every value is normalized by its own rank-row mean.</p>

                </div>
            </div>
        </div>
        <div class="fsdocs-tip" id="fs1">namespace Plotly</div>
<div class="fsdocs-tip" id="fs2">namespace Plotly.NET</div>
<div class="fsdocs-tip" id="fs3">module Defaults

from Plotly.NET<br /><em>&lt;summary&gt;
 Contains mutable global default values.

 Changing these values will apply the default values to all consecutive Chart generations.
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs4">val mutable DefaultDisplayOptions: DisplayOptions</div>
<div class="fsdocs-tip" id="fs5">Multiple items<br />type DisplayOptions =
  inherit DynamicObj
  new: unit -&gt; DisplayOptions
  static member addAdditionalHeadTags: additionalHeadTags: XmlNode list -&gt; (DisplayOptions -&gt; DisplayOptions)
  static member addDescription: description: XmlNode list -&gt; (DisplayOptions -&gt; DisplayOptions)
  static member combine: first: DisplayOptions -&gt; second: DisplayOptions -&gt; DisplayOptions
  static member getAdditionalHeadTags: displayOpts: DisplayOptions -&gt; XmlNode list
  static member getDescription: displayOpts: DisplayOptions -&gt; XmlNode list
  static member getPlotlyReference: displayOpts: DisplayOptions -&gt; PlotlyJSReference
  static member init: ?AdditionalHeadTags: XmlNode list * ?Description: XmlNode list * ?PlotlyJSReference: PlotlyJSReference -&gt; DisplayOptions
  static member initCDNOnly: unit -&gt; DisplayOptions
  ...<br /><br />--------------------<br />new: unit -&gt; DisplayOptions</div>
<div class="fsdocs-tip" id="fs6">static member DisplayOptions.init: ?AdditionalHeadTags: Giraffe.ViewEngine.HtmlElements.XmlNode list * ?Description: Giraffe.ViewEngine.HtmlElements.XmlNode list * ?PlotlyJSReference: PlotlyJSReference -&gt; DisplayOptions</div>
<div class="fsdocs-tip" id="fs7">type PlotlyJSReference =
  | CDN of string
  | Full
  | Require of string
  | NoReference<br /><em>&lt;summary&gt;
Sets how plotly is referenced in the head of html docs.
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs8">union case PlotlyJSReference.NoReference: PlotlyJSReference</div>
<div class="fsdocs-tip" id="fs9">module StyleParam

from Plotly.NET</div>
<div class="fsdocs-tip" id="fs10">namespace Plotly.NET.LayoutObjects</div>
<div class="fsdocs-tip" id="fs11">Multiple items<br />namespace FSharp<br /><br />--------------------<br />namespace Microsoft.FSharp</div>
<div class="fsdocs-tip" id="fs12">namespace FSharp.Stats</div>
<div class="fsdocs-tip" id="fs13">val rawData: Matrix&lt;float&gt;</div>
<div class="fsdocs-tip" id="fs14">Multiple items<br />val matrix: ll: seq&lt;#seq&lt;float&gt;&gt; -&gt; Matrix&lt;float&gt;<br /><br />--------------------<br />type matrix = Matrix&lt;float&gt;</div>
<div class="fsdocs-tip" id="fs15">val rawDataChart: GenericChart.GenericChart</div>
<div class="fsdocs-tip" id="fs16">property Matrix.Transpose: Matrix&lt;float&gt; with get</div>
<div class="fsdocs-tip" id="fs17">Multiple items<br />module Matrix

from FSharp.Stats<br /><br />--------------------<br />type Matrix&lt;&#39;T&gt; =
  | DenseRepr of DenseMatrix&lt;&#39;T&gt;
  | SparseRepr of SparseMatrix&lt;&#39;T&gt;
  interface IMatrixFormattable
  interface IFsiFormattable
  interface IEnumerable
  interface IEnumerable&lt;&#39;T&gt;
  interface IStructuralEquatable
  interface IStructuralComparable
  interface IComparable
  override Equals: yobj: obj -&gt; bool
  member Format: rowStartCount: int * rowEndCount: int * columnStartCount: int * columnEndCount: int * showInfo: bool -&gt; string + 2 overloads
  member FormatStrings: rowStartCount: int * rowEndCount: int * columnStartCount: int * columnEndCount: int -&gt; string[][]
  ...</div>
<div class="fsdocs-tip" id="fs18">val toJaggedArray: m: matrix -&gt; float[][]</div>
<div class="fsdocs-tip" id="fs19">Multiple items<br />module Array

from FSharp.Stats<br /><em>&lt;summary&gt;
 Module to compute common statistical measure on array
&lt;/summary&gt;</em><br /><br />--------------------<br />module Array

from Microsoft.FSharp.Collections<br /><em>&lt;summary&gt;Contains operations for working with arrays.&lt;/summary&gt;<br />&lt;remarks&gt;
  See also &lt;a href=&quot;https://docs.microsoft.com/dotnet/fsharp/language-reference/arrays&quot;&gt;F# Language Guide - Arrays&lt;/a&gt;.
 &lt;/remarks&gt;</em><br /><br />--------------------<br />type Array =
  new: unit -&gt; Array
  static member geomspace: start: float * stop: float * num: int * ?IncludeEndpoint: bool -&gt; float array
  static member linspace: start: float * stop: float * num: int * ?IncludeEndpoint: bool -&gt; float[]<br /><br />--------------------<br />new: unit -&gt; Array</div>
<div class="fsdocs-tip" id="fs20">val mapi: mapping: (int -&gt; &#39;T -&gt; &#39;U) -&gt; array: &#39;T[] -&gt; &#39;U[]<br /><em>&lt;summary&gt;Builds a new array whose elements are the results of applying the given function
 to each of the elements of the array. The integer index passed to the
 function indicates the index of element being transformed, starting at zero.&lt;/summary&gt;<br />&lt;param name=&quot;mapping&quot;&gt;The function to transform elements and their indices.&lt;/param&gt;<br />&lt;param name=&quot;array&quot;&gt;The input array.&lt;/param&gt;<br />&lt;returns&gt;The array of transformed elements.&lt;/returns&gt;<br />&lt;exception cref=&quot;T:System.ArgumentNullException&quot;&gt;Thrown when the input array is null.&lt;/exception&gt;<br />&lt;example id=&quot;mapi-1&quot;&gt;&lt;code lang=&quot;fsharp&quot;&gt;
 let inputs = [| 10; 10; 10 |]

 inputs |&amp;gt; Array.mapi (fun i x -&amp;gt; i + x)
 &lt;/code&gt;
 Evaluates to &lt;c&gt;[| 10; 11; 12 |]&lt;/c&gt;&lt;/example&gt;</em></div>
<div class="fsdocs-tip" id="fs21">val sampleID: int</div>
<div class="fsdocs-tip" id="fs22">val sample: float[]</div>
<div class="fsdocs-tip" id="fs23">val sampleIntensities: (int * float)[]</div>
<div class="fsdocs-tip" id="fs24">val gID: int</div>
<div class="fsdocs-tip" id="fs25">val intensity: float</div>
<div class="fsdocs-tip" id="fs26">type Chart =
  static member AnnotatedHeatmap: zData: seq&lt;#seq&lt;&#39;a1&gt;&gt; * annotationText: seq&lt;#seq&lt;string&gt;&gt; * ?Name: string * ?ShowLegend: bool * ?Opacity: float * ?X: seq&lt;&#39;a3&gt; * ?MultiX: seq&lt;seq&lt;&#39;a3&gt;&gt; * ?XGap: int * ?Y: seq&lt;&#39;a4&gt; * ?MultiY: seq&lt;seq&lt;&#39;a4&gt;&gt; * ?YGap: int * ?Text: &#39;a5 * ?MultiText: seq&lt;&#39;a5&gt; * ?ColorBar: ColorBar * ?ColorScale: Colorscale * ?ShowScale: bool * ?ReverseScale: bool * ?ZSmooth: SmoothAlg * ?Transpose: bool * ?UseWebGL: bool * ?ReverseYAxis: bool * ?UseDefaults: bool -&gt; GenericChart (requires &#39;a1 :&gt; IConvertible and &#39;a3 :&gt; IConvertible and &#39;a4 :&gt; IConvertible and &#39;a5 :&gt; IConvertible) + 1 overload
  static member Area: x: seq&lt;#IConvertible&gt; * y: seq&lt;#IConvertible&gt; * ?ShowMarkers: bool * ?Name: string * ?ShowLegend: bool * ?Opacity: float * ?MultiOpacity: seq&lt;float&gt; * ?Text: &#39;a2 * ?MultiText: seq&lt;&#39;a2&gt; * ?TextPosition: TextPosition * ?MultiTextPosition: seq&lt;TextPosition&gt; * ?MarkerColor: Color * ?MarkerColorScale: Colorscale * ?MarkerOutline: Line * ?MarkerSymbol: MarkerSymbol * ?MultiMarkerSymbol: seq&lt;MarkerSymbol&gt; * ?Marker: Marker * ?LineColor: Color * ?LineColorScale: Colorscale * ?LineWidth: float * ?LineDash: DrawingStyle * ?Line: Line * ?AlignmentGroup: string * ?OffsetGroup: string * ?StackGroup: string * ?Orientation: Orientation * ?GroupNorm: GroupNorm * ?FillColor: Color * ?FillPatternShape: PatternShape * ?FillPattern: Pattern * ?UseWebGL: bool * ?UseDefaults: bool -&gt; GenericChart (requires &#39;a2 :&gt; IConvertible) + 1 overload
  static member Bar: values: seq&lt;#IConvertible&gt; * ?Keys: seq&lt;&#39;a1&gt; * ?MultiKeys: seq&lt;seq&lt;&#39;a1&gt;&gt; * ?Name: string * ?ShowLegend: bool * ?Opacity: float * ?MultiOpacity: seq&lt;float&gt; * ?Text: &#39;a2 * ?MultiText: seq&lt;&#39;a2&gt; * ?MarkerColor: Color * ?MarkerColorScale: Colorscale * ?MarkerOutline: Line * ?MarkerPatternShape: PatternShape * ?MultiMarkerPatternShape: seq&lt;PatternShape&gt; * ?MarkerPattern: Pattern * ?Marker: Marker * ?Base: #IConvertible * ?Width: &#39;a4 * ?MultiWidth: seq&lt;&#39;a4&gt; * ?TextPosition: TextPosition * ?MultiTextPosition: seq&lt;TextPosition&gt; * ?UseDefaults: bool -&gt; GenericChart (requires &#39;a1 :&gt; IConvertible and &#39;a2 :&gt; IConvertible and &#39;a4 :&gt; IConvertible) + 1 overload
  static member BoxPlot: ?X: seq&lt;&#39;a0&gt; * ?MultiX: seq&lt;seq&lt;&#39;a0&gt;&gt; * ?Y: seq&lt;&#39;a1&gt; * ?MultiY: seq&lt;seq&lt;&#39;a1&gt;&gt; * ?Name: string * ?ShowLegend: bool * ?Text: &#39;a2 * ?MultiText: seq&lt;&#39;a2&gt; * ?FillColor: Color * ?MarkerColor: Color * ?Marker: Marker * ?Opacity: float * ?WhiskerWidth: float * ?BoxPoints: BoxPoints * ?BoxMean: BoxMean * ?Jitter: float * ?PointPos: float * ?Orientation: Orientation * ?OutlineColor: Color * ?OutlineWidth: float * ?Outline: Line * ?AlignmentGroup: string * ?OffsetGroup: string * ?Notched: bool * ?NotchWidth: float * ?QuartileMethod: QuartileMethod * ?UseDefaults: bool -&gt; GenericChart (requires &#39;a0 :&gt; IConvertible and &#39;a1 :&gt; IConvertible and &#39;a2 :&gt; IConvertible) + 2 overloads
  static member Bubble: x: seq&lt;#IConvertible&gt; * y: seq&lt;#IConvertible&gt; * sizes: seq&lt;int&gt; * ?Name: string * ?ShowLegend: bool * ?Opacity: float * ?MultiOpacity: seq&lt;float&gt; * ?Text: &#39;a2 * ?MultiText: seq&lt;&#39;a2&gt; * ?TextPosition: TextPosition * ?MultiTextPosition: seq&lt;TextPosition&gt; * ?MarkerColor: Color * ?MarkerColorScale: Colorscale * ?MarkerOutline: Line * ?MarkerSymbol: MarkerSymbol * ?MultiMarkerSymbol: seq&lt;MarkerSymbol&gt; * ?Marker: Marker * ?LineColor: Color * ?LineColorScale: Colorscale * ?LineWidth: float * ?LineDash: DrawingStyle * ?Line: Line * ?AlignmentGroup: string * ?OffsetGroup: string * ?StackGroup: string * ?Orientation: Orientation * ?GroupNorm: GroupNorm * ?UseWebGL: bool * ?UseDefaults: bool -&gt; GenericChart (requires &#39;a2 :&gt; IConvertible) + 1 overload
  static member Candlestick: ``open`` : seq&lt;#IConvertible&gt; * high: seq&lt;#IConvertible&gt; * low: seq&lt;#IConvertible&gt; * close: seq&lt;#IConvertible&gt; * ?X: seq&lt;&#39;a4&gt; * ?MultiX: seq&lt;seq&lt;&#39;a4&gt;&gt; * ?Name: string * ?ShowLegend: bool * ?Opacity: float * ?Text: &#39;a5 * ?MultiText: seq&lt;&#39;a5&gt; * ?Line: Line * ?IncreasingColor: Color * ?Increasing: FinanceMarker * ?DecreasingColor: Color * ?Decreasing: FinanceMarker * ?WhiskerWidth: float * ?ShowXAxisRangeSlider: bool * ?UseDefaults: bool -&gt; GenericChart (requires &#39;a4 :&gt; IConvertible and &#39;a5 :&gt; IConvertible) + 2 overloads
  static member Column: values: seq&lt;#IConvertible&gt; * ?Keys: seq&lt;&#39;a1&gt; * ?MultiKeys: seq&lt;seq&lt;&#39;a1&gt;&gt; * ?Name: string * ?ShowLegend: bool * ?Opacity: float * ?MultiOpacity: seq&lt;float&gt; * ?Text: &#39;a2 * ?MultiText: seq&lt;&#39;a2&gt; * ?MarkerColor: Color * ?MarkerColorScale: Colorscale * ?MarkerOutline: Line * ?MarkerPatternShape: PatternShape * ?MultiMarkerPatternShape: seq&lt;PatternShape&gt; * ?MarkerPattern: Pattern * ?Marker: Marker * ?Base: #IConvertible * ?Width: &#39;a4 * ?MultiWidth: seq&lt;&#39;a4&gt; * ?TextPosition: TextPosition * ?MultiTextPosition: seq&lt;TextPosition&gt; * ?UseDefaults: bool -&gt; GenericChart (requires &#39;a1 :&gt; IConvertible and &#39;a2 :&gt; IConvertible and &#39;a4 :&gt; IConvertible) + 1 overload
  static member Contour: zData: seq&lt;#seq&lt;&#39;a1&gt;&gt; * ?Name: string * ?ShowLegend: bool * ?Opacity: float * ?X: seq&lt;&#39;a2&gt; * ?MultiX: seq&lt;seq&lt;&#39;a2&gt;&gt; * ?Y: seq&lt;&#39;a3&gt; * ?MultiY: seq&lt;seq&lt;&#39;a3&gt;&gt; * ?Text: &#39;a4 * ?MultiText: seq&lt;&#39;a4&gt; * ?ColorBar: ColorBar * ?ColorScale: Colorscale * ?ShowScale: bool * ?ReverseScale: bool * ?Transpose: bool * ?ContourLineColor: Color * ?ContourLineDash: DrawingStyle * ?ContourLineSmoothing: float * ?ContourLine: Line * ?ContoursColoring: ContourColoring * ?ContoursOperation: ConstraintOperation * ?ContoursType: ContourType * ?ShowContourLabels: bool * ?ContourLabelFont: Font * ?Contours: Contours * ?FillColor: Color * ?NContours: int * ?UseDefaults: bool -&gt; GenericChart (requires &#39;a1 :&gt; IConvertible and &#39;a2 :&gt; IConvertible and &#39;a3 :&gt; IConvertible and &#39;a4 :&gt; IConvertible)
  static member Funnel: x: seq&lt;#IConvertible&gt; * y: seq&lt;#IConvertible&gt; * ?Name: string * ?ShowLegend: bool * ?Opacity: float * ?Width: float * ?Offset: float * ?Text: &#39;a2 * ?MultiText: seq&lt;&#39;a2&gt; * ?TextPosition: TextPosition * ?MultiTextPosition: seq&lt;TextPosition&gt; * ?Orientation: Orientation * ?AlignmentGroup: string * ?OffsetGroup: string * ?MarkerColor: Color * ?MarkerOutline: Line * ?Marker: Marker * ?TextInfo: TextInfo * ?ConnectorLineColor: Color * ?ConnectorLineStyle: DrawingStyle * ?ConnectorFillColor: Color * ?ConnectorLine: Line * ?Connector: FunnelConnector * ?InsideTextFont: Font * ?OutsideTextFont: Font * ?UseDefaults: bool -&gt; GenericChart (requires &#39;a2 :&gt; IConvertible)
  static member Heatmap: zData: seq&lt;#seq&lt;&#39;a1&gt;&gt; * ?X: seq&lt;&#39;a2&gt; * ?MultiX: seq&lt;seq&lt;&#39;a2&gt;&gt; * ?Y: seq&lt;&#39;a3&gt; * ?MultiY: seq&lt;seq&lt;&#39;a3&gt;&gt; * ?Name: string * ?ShowLegend: bool * ?Opacity: float * ?XGap: int * ?YGap: int * ?Text: &#39;a4 * ?MultiText: seq&lt;&#39;a4&gt; * ?ColorBar: ColorBar * ?ColorScale: Colorscale * ?ShowScale: bool * ?ReverseScale: bool * ?ZSmooth: SmoothAlg * ?Transpose: bool * ?UseWebGL: bool * ?ReverseYAxis: bool * ?UseDefaults: bool -&gt; GenericChart (requires &#39;a1 :&gt; IConvertible and &#39;a2 :&gt; IConvertible and &#39;a3 :&gt; IConvertible and &#39;a4 :&gt; IConvertible) + 1 overload
  ...</div>
<div class="fsdocs-tip" id="fs27">static member Chart.Column: keysValues: seq&lt;#System.IConvertible * #System.IConvertible&gt; * ?Name: string * ?ShowLegend: bool * ?Opacity: float * ?MultiOpacity: seq&lt;float&gt; * ?Text: &#39;c * ?MultiText: seq&lt;&#39;c&gt; * ?MarkerColor: Color * ?MarkerColorScale: Colorscale * ?MarkerOutline: Line * ?MarkerPatternShape: PatternShape * ?MultiMarkerPatternShape: seq&lt;PatternShape&gt; * ?MarkerPattern: TraceObjects.Pattern * ?Marker: TraceObjects.Marker * ?Base: #System.IConvertible * ?Width: &#39;e * ?MultiWidth: seq&lt;&#39;e&gt; * ?TextPosition: TextPosition * ?MultiTextPosition: seq&lt;TextPosition&gt; * ?UseDefaults: bool -&gt; GenericChart.GenericChart (requires &#39;c :&gt; System.IConvertible and &#39;e :&gt; System.IConvertible)<br />static member Chart.Column: values: seq&lt;#System.IConvertible&gt; * ?Keys: seq&lt;&#39;a1&gt; * ?MultiKeys: seq&lt;seq&lt;&#39;a1&gt;&gt; * ?Name: string * ?ShowLegend: bool * ?Opacity: float * ?MultiOpacity: seq&lt;float&gt; * ?Text: &#39;a2 * ?MultiText: seq&lt;&#39;a2&gt; * ?MarkerColor: Color * ?MarkerColorScale: Colorscale * ?MarkerOutline: Line * ?MarkerPatternShape: PatternShape * ?MultiMarkerPatternShape: seq&lt;PatternShape&gt; * ?MarkerPattern: TraceObjects.Pattern * ?Marker: TraceObjects.Marker * ?Base: #System.IConvertible * ?Width: &#39;a4 * ?MultiWidth: seq&lt;&#39;a4&gt; * ?TextPosition: TextPosition * ?MultiTextPosition: seq&lt;TextPosition&gt; * ?UseDefaults: bool -&gt; GenericChart.GenericChart (requires &#39;a1 :&gt; System.IConvertible and &#39;a2 :&gt; System.IConvertible and &#39;a4 :&gt; System.IConvertible)</div>
<div class="fsdocs-tip" id="fs28">union case HoverInfo.Name: HoverInfo</div>
<div class="fsdocs-tip" id="fs29">val sprintf: format: Printf.StringFormat&lt;&#39;T&gt; -&gt; &#39;T<br /><em>&lt;summary&gt;Print to a string using the given format.&lt;/summary&gt;<br />&lt;param name=&quot;format&quot;&gt;The formatter.&lt;/param&gt;<br />&lt;returns&gt;The formatted result.&lt;/returns&gt;<br />&lt;example&gt;See &lt;c&gt;Printf.sprintf&lt;/c&gt; (link: &lt;see cref=&quot;M:Microsoft.FSharp.Core.PrintfModule.PrintFormatToStringThen``1&quot; /&gt;) for examples.&lt;/example&gt;</em></div>
<div class="fsdocs-tip" id="fs30">static member Chart.combine: gCharts: seq&lt;GenericChart.GenericChart&gt; -&gt; GenericChart.GenericChart</div>
<div class="fsdocs-tip" id="fs31">static member Chart.withTemplate: template: Template -&gt; (GenericChart.GenericChart -&gt; GenericChart.GenericChart)</div>
<div class="fsdocs-tip" id="fs32">module ChartTemplates

from Plotly.NET</div>
<div class="fsdocs-tip" id="fs33">val lightMirrored: Template</div>
<div class="fsdocs-tip" id="fs34">static member Chart.withXAxisStyle: ?TitleText: string * ?TitleFont: Font * ?TitleStandoff: int * ?Title: Title * ?Color: Color * ?AxisType: AxisType * ?MinMax: (#System.IConvertible * #System.IConvertible) * ?Mirror: Mirror * ?ShowSpikes: bool * ?SpikeColor: Color * ?SpikeThickness: int * ?ShowLine: bool * ?LineColor: Color * ?ShowGrid: bool * ?GridColor: Color * ?GridDash: DrawingStyle * ?ZeroLine: bool * ?ZeroLineColor: Color * ?Anchor: LinearAxisId * ?Side: Side * ?Overlaying: LinearAxisId * ?Domain: (float * float) * ?Position: float * ?CategoryOrder: CategoryOrder * ?CategoryArray: seq&lt;#System.IConvertible&gt; * ?RangeSlider: RangeSlider * ?RangeSelector: RangeSelector * ?BackgroundColor: Color * ?ShowBackground: bool * ?Id: SubPlotId -&gt; (GenericChart.GenericChart -&gt; GenericChart.GenericChart)</div>
<div class="fsdocs-tip" id="fs35">static member Chart.withYAxisStyle: ?TitleText: string * ?TitleFont: Font * ?TitleStandoff: int * ?Title: Title * ?Color: Color * ?AxisType: AxisType * ?MinMax: (#System.IConvertible * #System.IConvertible) * ?Mirror: Mirror * ?ShowSpikes: bool * ?SpikeColor: Color * ?SpikeThickness: int * ?ShowLine: bool * ?LineColor: Color * ?ShowGrid: bool * ?GridColor: Color * ?GridDash: DrawingStyle * ?ZeroLine: bool * ?ZeroLineColor: Color * ?Anchor: LinearAxisId * ?Side: Side * ?Overlaying: LinearAxisId * ?AutoShift: bool * ?Shift: int * ?Domain: (float * float) * ?Position: float * ?CategoryOrder: CategoryOrder * ?CategoryArray: seq&lt;#System.IConvertible&gt; * ?RangeSlider: RangeSlider * ?RangeSelector: RangeSelector * ?BackgroundColor: Color * ?ShowBackground: bool * ?Id: SubPlotId -&gt; (GenericChart.GenericChart -&gt; GenericChart.GenericChart)</div>
<div class="fsdocs-tip" id="fs36">static member Chart.withTitle: title: Title -&gt; (GenericChart.GenericChart -&gt; GenericChart.GenericChart)<br />static member Chart.withTitle: title: string * ?TitleFont: Font -&gt; (GenericChart.GenericChart -&gt; GenericChart.GenericChart)</div>
<div class="fsdocs-tip" id="fs37">module GenericChart

from Plotly.NET<br /><em>&lt;summary&gt;
 Module to represent a GenericChart
&lt;/summary&gt;</em></div>
<div class="fsdocs-tip" id="fs38">val toChartHTML: gChart: GenericChart.GenericChart -&gt; string</div>
<div class="fsdocs-tip" id="fs39">val mor: Signal.Normalization.MorResult<br /><em>&#160;actual median of ratios normalization. 1 is added to each intensity to get rid of the empty intensities.</em></div>
<div class="fsdocs-tip" id="fs40">namespace FSharp.Stats.Signal</div>
<div class="fsdocs-tip" id="fs41">module Normalization

from FSharp.Stats.Signal</div>
<div class="fsdocs-tip" id="fs42">val medianOfRatiosBy: f: (float -&gt; float) -&gt; data: Matrix&lt;float&gt; -&gt; Signal.Normalization.MorResult<br /><em>&lt;summary&gt;
   Median of ratios normalization As used by Deseq2, see: https://github.com/hbctraining/DGE_workshop/blob/master/lessons/02_DGE_count_normalization.md . 
   Rows are genes, columns are samples
 &lt;/summary&gt;<br />&lt;param name=&quot;f&quot;&gt;The transformation function is applied on all values of the matrix before calculating the normalization factors.&lt;/param&gt;<br />&lt;param name=&quot;data&quot;&gt;data matrix with columns as features (samples,time points) and rows as measured entities (genes,proteins).&lt;/param&gt;<br />&lt;returns&gt;Normalized data matrix with correction factors and normalization function.&lt;/returns&gt;<br />&lt;example&gt;&lt;code&gt; 
   // raw data with proteins as rows and samples as columns
   let myData = Matrix.init 500 5 (fun _ _ -&amp;gt; rnd.NextDouble())
   let normedData = Normalization.medianOfRatiosBy (fun x -&amp;gt; ln (x+1)) myData
 &lt;/code&gt;&lt;/example&gt;</em></div>
<div class="fsdocs-tip" id="fs43">val x: float</div>
<div class="fsdocs-tip" id="fs44">val morNormedData: Matrix&lt;float&gt;<br /><em>&#160;Matrix of normalized data in the same order as the input matrix</em></div>
<div class="fsdocs-tip" id="fs45">Signal.Normalization.MorResult.NormedData: Matrix&lt;float&gt;</div>
<div class="fsdocs-tip" id="fs46">val corrFactors: string<br /><em>&#160;Correction factors to assess the strenght of the applied normalization (1 indicates no normalization)</em></div>
<div class="fsdocs-tip" id="fs47">val cf1: float</div>
<div class="fsdocs-tip" id="fs48">Multiple items<br />module Seq

from FSharp.Stats<br /><em>&lt;summary&gt;
 Module to compute common statistical measure
&lt;/summary&gt;</em><br /><br />--------------------<br />module Seq

from Microsoft.FSharp.Collections<br /><em>&lt;summary&gt;Contains operations for working with values of type &lt;see cref=&quot;T:Microsoft.FSharp.Collections.seq`1&quot; /&gt;.&lt;/summary&gt;</em><br /><br />--------------------<br />type Seq =
  new: unit -&gt; Seq
  static member geomspace: start: float * stop: float * num: int * ?IncludeEndpoint: bool -&gt; seq&lt;float&gt;
  static member linspace: start: float * stop: float * num: int * ?IncludeEndpoint: bool -&gt; seq&lt;float&gt;<br /><br />--------------------<br />new: unit -&gt; Seq</div>
<div class="fsdocs-tip" id="fs49">val item: index: int -&gt; source: seq&lt;&#39;T&gt; -&gt; &#39;T<br /><em>&lt;summary&gt;Computes the element at the specified index in the collection.&lt;/summary&gt;<br />&lt;param name=&quot;index&quot;&gt;The index of the element to retrieve.&lt;/param&gt;<br />&lt;param name=&quot;source&quot;&gt;The input sequence.&lt;/param&gt;<br />&lt;returns&gt;The element at the specified index of the sequence.&lt;/returns&gt;<br />&lt;exception cref=&quot;T:System.ArgumentNullException&quot;&gt;Thrown when the input sequence is null.&lt;/exception&gt;<br />&lt;exception cref=&quot;T:System.ArgumentException&quot;&gt;Thrown when the index is negative or the input sequence does not contain enough elements.&lt;/exception&gt;<br />&lt;example id=&quot;item-1&quot;&gt;&lt;code lang=&quot;fsharp&quot;&gt;
 let inputs = [&quot;a&quot;; &quot;b&quot;; &quot;c&quot;]

 inputs |&amp;gt; Seq.item 1
 &lt;/code&gt;
 Evaluates to &lt;c&gt;&quot;b&quot;&lt;/c&gt;&lt;/example&gt;<br />&lt;example id=&quot;item-2&quot;&gt;&lt;code lang=&quot;fsharp&quot;&gt;
 let inputs = [&quot;a&quot;; &quot;b&quot;; &quot;c&quot;]

 inputs |&amp;gt; Seq.item 4
 &lt;/code&gt;
 Throws &lt;c&gt;ArgumentException&lt;/c&gt;&lt;/example&gt;</em></div>
<div class="fsdocs-tip" id="fs50">Signal.Normalization.MorResult.CorrFactors: seq&lt;float&gt;</div>
<div class="fsdocs-tip" id="fs51">val cf2: float</div>
<div class="fsdocs-tip" id="fs52">val cf3: float</div>
<div class="fsdocs-tip" id="fs53">val normedDataChart: GenericChart.GenericChart</div>
<div class="fsdocs-tip" id="fs54">val quantileNorm: Matrix&lt;float&gt;</div>
<div class="fsdocs-tip" id="fs55">val quantile: data: Matrix&lt;float&gt; -&gt; Matrix&lt;float&gt;<br /><em>&lt;summary&gt;
   Quantile normalization with equal number of elements (rows) for each sample (column). 
   Column mean and column standard deviation are qual after normalization.
   Rows are genes, columns are samples.
 &lt;/summary&gt;<br />&lt;param name=&quot;data&quot;&gt;data matrix with columns as measured entities and rows as features (samples,time points) (genes,proteins).&lt;/param&gt;<br />&lt;returns&gt;Normalized data matrix.&lt;/returns&gt;<br />&lt;example&gt;&lt;code&gt; 
   // raw data with proteins as rows and samples as columns
   let myData = Matrix.init 500 5 (fun _ _ -&amp;gt; rnd.NextDouble())
   let normedData = Normalization.quantile myData
 &lt;/code&gt;&lt;/example&gt;</em></div>
<div class="fsdocs-tip" id="fs56">val normedDataQuantileChart: GenericChart.GenericChart</div>

    </div>

    <!-- BEGIN SEARCH BOX: this adds support for the search box -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/JavaScript-autoComplete/1.0.4/auto-complete.css" />
    <script type="text/javascript">var fsdocs_search_baseurl = 'https://fslab.org/FSharp.Stats/'</script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/lunr.js/2.3.8/lunr.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/JavaScript-autoComplete/1.0.4/auto-complete.min.js"></script>
    <script type="text/javascript" src="https://fslab.org/FSharp.Stats/content/fsdocs-search.js"></script>
    <!-- END SEARCH BOX: this adds support for the search box -->
</body>

</html>